<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="NetW1reAvalonia.Core.Views.RoutedViews.PacketDetailsView"
             MinWidth="600">
    
    <UserControl.Styles>
        <Style Selector="TextBlock.Label">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#E2E8F0"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
        <Style Selector="TextBlock.Value">
            <Setter Property="Foreground" Value="#D1D5DB"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
        <Style Selector="TextBlock.SectionHeader">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>
        <Style Selector="TextBlock.AppData">
            <Setter Property="Foreground" Value="#00FF00"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Background" Value="Transparent"/>
        </Style>
        <Style Selector="TabItem">
            <Setter Property="Background">
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="0%,100%">
                    <GradientStop Color="#4A5568" Offset="0"/>
                    <GradientStop Color="#2D3748" Offset="1"/>
                </LinearGradientBrush>
            </Setter>
            <Setter Property="Foreground" Value="#E2E8F0"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="Margin" Value="0,0,4,0"/>
            <Setter Property="CornerRadius" Value="8,8,0,0"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="MinHeight" Value="42"/>
            <Setter Property="MinWidth" Value="120"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <ControlTemplate>
                    <Border Background="{TemplateBinding Background}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            Padding="{TemplateBinding Padding}"
                            BorderThickness="0"
                            BoxShadow="0 2 8 rgba(0,0,0,0.1)">
                        <ContentPresenter Content="{TemplateBinding Header}"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                </ControlTemplate>
            </Setter>
        </Style>
        <Style Selector="TabItem:selected">
            <Setter Property="Background">
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="0%,100%">
                    <GradientStop Color="#2563EB" Offset="0"/>
                    <GradientStop Color="#1D4ED8" Offset="1"/>
                </LinearGradientBrush>
            </Setter>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
        <Style Selector="TabItem:pointerover:not(:selected)">
            <Setter Property="Background">
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="0%,100%">
                    <GradientStop Color="#5A67D8" Offset="0"/>
                    <GradientStop Color="#4C51BF" Offset="1"/>
                </LinearGradientBrush>
            </Setter>
            <Setter Property="Foreground" Value="White"/>
        </Style>
        <Style Selector="TabControl">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Background" Value="Transparent"/>
        </Style>
    </UserControl.Styles>
    
    <Grid Background="#1E293B">
        <Border Background="#0F172A" Padding="12,8" VerticalAlignment="Top" Height="40">
            <TextBlock Text="{Binding PacketInfo.Protocol, StringFormat='Protocol: {0}'}" 
                       FontSize="14" FontWeight="SemiBold" Foreground="#F1F5F9"/>
        </Border>
        
        <TabControl Margin="0,40,0,0" Background="Transparent" BorderThickness="0">
            
            <TabItem Header="Overview">
                <ScrollViewer Padding="16" Background="#374151" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="18">
                        
                        <StackPanel Spacing="10">
                            <TextBlock Text="Summary" Classes="SectionHeader" Foreground="#F59E0B"/>
                            <Border Background="#1F2937" CornerRadius="6" Padding="14">
                                <TextBlock Text="{Binding PacketInfo.PacketSummary}" 
                                           Foreground="#D1D5DB" FontFamily="Consolas" FontSize="11"
                                           TextWrapping="Wrap"/>
                            </Border>
                        </StackPanel>
                        
                        <StackPanel Spacing="10">
                            <TextBlock Text="General Information" Classes="SectionHeader" Foreground="#10B981"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Timestamp:" Classes="Label"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.Timestamp, StringFormat='{}{0:yyyy-MM-dd HH:mm:ss.fff}'}" Classes="Value"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Packet Length:" Classes="Label" Margin="0,8,0,0"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.Length, StringFormat='{}{0} bytes'}" Classes="Value" Margin="0,8,0,0"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Direction:" Classes="Label" Margin="0,8,0,0"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding PacketInfo.Direction}" Classes="Value" Margin="0,8,0,0"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Flow Key:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.FlowKey, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding PacketInfo.FlowKey}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.FlowKey, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Packet in Flow:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.PacketInFlow, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding PacketInfo.PacketInFlow}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.PacketInFlow, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="5" Grid.Column="0" Text="Info:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.Info, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding PacketInfo.Info}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.Info, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="10" IsVisible="{Binding HasEthernetInfo}">
                            <TextBlock Text="Ethernet Layer" Classes="SectionHeader" Foreground="#8B5CF6"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Source MAC:" Classes="Label"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.SourceMAC}" Classes="Value"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Destination MAC:" Classes="Label" Margin="0,8,0,0"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.DestinationMAC}" Classes="Value" Margin="0,8,0,0"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Ethernet Type:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.EthernetType, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding PacketInfo.EthernetType}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.EthernetType, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="10">
                            <TextBlock Text="Status" Classes="SectionHeader" Foreground="#8B5CF6"/>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Border Background="#DC2626" CornerRadius="12" Padding="10,6"
                                        IsVisible="{Binding PacketInfo.IsSuspicious}">
                                    <TextBlock Text="🚨 Suspicious" Foreground="White" FontSize="11" FontWeight="Bold"/>
                                </Border>                                
                                <Border Background="#059669" CornerRadius="12" Padding="10,6"
                                        IsVisible="{Binding PacketInfo.IsEncrypted}">
                                    <TextBlock Text="🔒 Encrypted" Foreground="White" FontSize="11" FontWeight="Bold"/>
                                </Border>

                                <Border Background="#F59E0B" CornerRadius="12" Padding="10,6"
                                        IsVisible="{Binding PacketInfo.HasPayload}">
                                    <TextBlock Text="📦 Has Payload" Foreground="White" FontSize="11" FontWeight="Bold"/>
                                </Border>
                            </StackPanel>
                            
                            <TextBlock Text="{Binding PacketInfo.SuspiciousReason, StringFormat='Reason: {0}'}" 
                                       Foreground="#FCA5A5" FontSize="11" FontStyle="Italic" Margin="0,6,0,0"
                                       IsVisible="{Binding PacketInfo.SuspiciousReason, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Network">
                <ScrollViewer Padding="16" Background="#374151" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="18">
                        
                        <StackPanel Spacing="10">
                            <TextBlock Text="IP Layer Information" Classes="SectionHeader" Foreground="#EF4444"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Source IP:" Classes="Label"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.SourceIP}" Classes="Value"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Destination IP:" Classes="Label" Margin="0,8,0,0"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.DestinationIP}" Classes="Value" Margin="0,8,0,0"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="IP Version:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.IpVersion, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding PacketInfo.IpVersion}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.IpVersion, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Header Length:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.IpHeaderLength, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding PacketInfo.IpHeaderLength, StringFormat='{}{0} bytes'}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.IpHeaderLength, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="TTL:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.Ttl, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding PacketInfo.Ttl}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.Ttl, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="5" Grid.Column="0" Text="Total Length:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TotalLength, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding PacketInfo.TotalLength, StringFormat='{}{0} bytes'}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TotalLength, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="6" Grid.Column="0" Text="Identification:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.Identification, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="6" Grid.Column="1" Text="{Binding PacketInfo.Identification, StringFormat='0x{0:X4}'}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.Identification, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="7" Grid.Column="0" Text="Fragment Offset:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.FragmentOffset, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="7" Grid.Column="1" Text="{Binding PacketInfo.FragmentOffset}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.FragmentOffset, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="8" Grid.Column="0" Text="Checksum:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding HasIpChecksum}"/>
                                <TextBlock Grid.Row="8" Grid.Column="1" Text="{Binding PacketInfo.IpChecksum}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding HasIpChecksum}"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="10" IsVisible="{Binding IsArp}">
                            <TextBlock Text="ARP Information" Classes="SectionHeader" Foreground="#F59E0B"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Operation:" Classes="Label"
                                           IsVisible="{Binding PacketInfo.ArpOperation, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.ArpOperation}" Classes="Value"
                                           IsVisible="{Binding PacketInfo.ArpOperation, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Sender IP:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.ArpSenderIp, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.ArpSenderIp}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.ArpSenderIp, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Target IP:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.ArpTargetIp, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding PacketInfo.ArpTargetIp}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.ArpTargetIp, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Sender MAC:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.ArpSenderMac, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding PacketInfo.ArpSenderMac}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.ArpSenderMac, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Target MAC:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.ArpTargetMac, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding PacketInfo.ArpTargetMac}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.ArpTargetMac, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="10" IsVisible="{Binding IsIcmp}">
                            <TextBlock Text="ICMP Information" Classes="SectionHeader" Foreground="#06B6D4"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Type:" Classes="Label"
                                           IsVisible="{Binding PacketInfo.IcmpType, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.IcmpType}" Classes="Value"
                                           IsVisible="{Binding PacketInfo.IcmpType, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Code:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.IcmpCode, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.IcmpCode}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.IcmpCode, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                            </Grid>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Transport">
                <ScrollViewer Padding="16" Background="#374151" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="18">
                        
                        <StackPanel Spacing="10" IsVisible="{Binding IsTcp}">
                            <TextBlock Text="TCP Information" Classes="SectionHeader" Foreground="#10B981"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Source Port:" Classes="Label"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.SourcePort}" Classes="Value"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Destination Port:" Classes="Label" Margin="0,8,0,0"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.DestinationPort}" Classes="Value" Margin="0,8,0,0"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Sequence Number:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpSequenceNumber, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding PacketInfo.TcpSequenceNumber, StringFormat='0x{0:X8}'}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpSequenceNumber, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Ack Number:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpAcknowledgmentNumber, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding PacketInfo.TcpAcknowledgmentNumber, StringFormat='0x{0:X8}'}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpAcknowledgmentNumber, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Header Length:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpHeaderLength, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding PacketInfo.TcpHeaderLength, StringFormat='{}{0} bytes'}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpHeaderLength, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="5" Grid.Column="0" Text="TCP Flags:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpFlags, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding PacketInfo.TcpFlags}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpFlags, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="6" Grid.Column="0" Text="Window Size:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpWindowSize, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="6" Grid.Column="1" Text="{Binding PacketInfo.TcpWindowSize}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpWindowSize, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="7" Grid.Column="0" Text="Checksum:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpChecksum, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="7" Grid.Column="1" Text="{Binding PacketInfo.TcpChecksum}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpChecksum, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="8" Grid.Column="0" Text="Urgent Pointer:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpUrgentPointer, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="8" Grid.Column="1" Text="{Binding PacketInfo.TcpUrgentPointer}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TcpUrgentPointer, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="10" IsVisible="{Binding IsUdp}">
                            <TextBlock Text="UDP Information" Classes="SectionHeader" Foreground="#3B82F6"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Source Port:" Classes="Label"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.SourcePort}" Classes="Value"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Destination Port:" Classes="Label" Margin="0,8,0,0"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.DestinationPort}" Classes="Value" Margin="0,8,0,0"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="UDP Length:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.UdpLength, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding PacketInfo.UdpLength, StringFormat='{}{0} bytes'}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.UdpLength, Converter={x:Static ObjectConverters.IsNotNull}}"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="UDP Checksum:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding HasUdpChecksum}"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding PacketInfo.UdpChecksum}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding HasUdpChecksum}"/>
                            </Grid>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Application">
                <ScrollViewer Padding="16" Background="#374151" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="18">
                        
                        <StackPanel Spacing="10" IsVisible="{Binding HasHttpData}">
                            <TextBlock Text="HTTP Information" Classes="SectionHeader" Foreground="#F59E0B"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Method:" Classes="Label"
                                           IsVisible="{Binding PacketInfo.HttpMethod, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.HttpMethod}" Classes="Value"
                                           IsVisible="{Binding PacketInfo.HttpMethod, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Host:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.HttpHost, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.HttpHost}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.HttpHost, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Content-Type:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.HttpContentType, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding PacketInfo.HttpContentType}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.HttpContentType, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="3" Grid.Column="0" Text="User-Agent:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.HttpUserAgent, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding PacketInfo.HttpUserAgent}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.HttpUserAgent, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="10" IsVisible="{Binding HasDnsData}">
                            <TextBlock Text="DNS Information" Classes="SectionHeader" Foreground="#8B5CF6"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Query:" Classes="Label"
                                           IsVisible="{Binding PacketInfo.DnsQuery, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.DnsQuery}" Classes="Value"
                                           IsVisible="{Binding PacketInfo.DnsQuery, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Query Type:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.DnsQueryType, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.DnsQueryType}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.DnsQueryType, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Response:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.DnsResponse, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding PacketInfo.DnsResponse}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.DnsResponse, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="10" IsVisible="{Binding HasTlsData}">
                            <TextBlock Text="TLS Information" Classes="SectionHeader" Foreground="#059669"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="SNI:" Classes="Label"
                                           IsVisible="{Binding PacketInfo.TlsSni, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.TlsSni}" Classes="Value"
                                           IsVisible="{Binding PacketInfo.TlsSni, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Version:" Classes="Label" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TlsVersion, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.TlsVersion}" Classes="Value" Margin="0,8,0,0"
                                           IsVisible="{Binding PacketInfo.TlsVersion, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                            </Grid>
                        </StackPanel>

                        <StackPanel Spacing="10" IsVisible="{Binding HasApplicationData}">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <TextBlock Text="Application Data" Classes="SectionHeader" Foreground="#F59E0B"/>
                                <Button Content="Copy" 
                                        Background="#F59E0B" BorderBrush="#D97706" Foreground="White"
                                        Padding="8,4" CornerRadius="4" FontSize="11"
                                        Command="{Binding CopyApplicationDataCommand}"
                                        ToolTip.Tip="Copy application data to clipboard"/>
                            </StackPanel>
                            <Border Background="#0A0A0A" CornerRadius="6" Padding="14" BorderBrush="#333" BorderThickness="1">
                                <ScrollViewer MaxHeight="350" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                    <TextBlock Text="{Binding PacketInfo.ApplicationData}" 
                                               Classes="AppData"
                                               TextWrapping="NoWrap"/>
                                </ScrollViewer>
                            </Border>
                        </StackPanel>

                        <StackPanel Spacing="10" IsVisible="{Binding HasPayloadPreview}">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <TextBlock Text="Payload Preview" Classes="SectionHeader" Foreground="#06B6D4"/>
                                <Button Content="Copy" 
                                        Background="#0891B2" BorderBrush="#0E7490" Foreground="White"
                                        Padding="8,4" CornerRadius="4" FontSize="11"
                                        Command="{Binding CopyPayloadPreviewCommand}"
                                        ToolTip.Tip="Copy payload preview to clipboard"/>
                            </StackPanel>
                            <Border Background="#1F2937" CornerRadius="6" Padding="14">
                                <ScrollViewer MaxHeight="200" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                    <TextBlock Text="{Binding PacketInfo.PayloadPreview}" 
                                               Foreground="#D1D5DB" FontFamily="Consolas" FontSize="11"
                                               TextWrapping="NoWrap"/>
                                </ScrollViewer>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header="Raw Data">
                <ScrollViewer Padding="16" Background="#374151" VerticalScrollBarVisibility="Auto">
                    <StackPanel Spacing="18">
                        
                        <StackPanel Spacing="10">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <TextBlock Text="Hex Dump" Classes="SectionHeader" Foreground="#F472B6"/>
                                <Button Content="Copy" 
                                        Background="#EC4899" BorderBrush="#DB2777" Foreground="White"
                                        Padding="8,4" CornerRadius="4" FontSize="11"
                                        Command="{Binding CopyHexDumpCommand}"
                                        ToolTip.Tip="Copy hex dump to clipboard"/>
                            </StackPanel>                            <Border Background="#0F172A" CornerRadius="6" Padding="14" Margin="0,0,0,60">
                                <ScrollViewer MaxHeight="450" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                    <TextBlock Text="{Binding PacketInfo.HexDump}" 
                                               Foreground="#D1D5DB" FontFamily="Consolas" FontSize="10"
                                               TextWrapping="NoWrap"/>
                                </ScrollViewer>
                            </Border>
                        </StackPanel>                       
                        <StackPanel Spacing="10" IsVisible="{Binding HasPayloadText}" Margin="0,0,0,60">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <TextBlock Text="Payload Text" Classes="SectionHeader" Foreground="#06B6D4"/>
                                <Button Content="Copy" 
                                        Background="#0891B2" BorderBrush="#0E7490" Foreground="White"
                                        Padding="8,4" CornerRadius="4" FontSize="11"
                                        Command="{Binding CopyPayloadTextCommand}"
                                        ToolTip.Tip="Copy payload text to clipboard"/>
                            </StackPanel>
                            <Border Background="#0F172A" CornerRadius="6" Padding="14">
                                <ScrollViewer MaxHeight="350" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                    <TextBlock Text="{Binding PacketInfo.PayloadText}" 
                                               Foreground="#D1D5DB" FontFamily="Consolas" FontSize="11"
                                               TextWrapping="NoWrap"/>
                                </ScrollViewer>
                            </Border>
                        </StackPanel>

                        <StackPanel Spacing="10">
                            <TextBlock Text="Raw Packet Information" Classes="SectionHeader" Foreground="#8B5CF6"/>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Raw Data Size:" Classes="Label"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PacketInfo.RawData.Length, StringFormat='{}{0} bytes'}" Classes="Value"/>

                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Payload Size:" Classes="Label" Margin="0,8,0,0"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PacketInfo.PayloadData.Length, StringFormat='{}{0} bytes'}" Classes="Value" Margin="0,8,0,0"/>
                            </Grid>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>
